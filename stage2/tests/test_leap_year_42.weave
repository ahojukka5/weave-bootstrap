(program
  (name "test-leap-year-42")
  (doc "Check if a year is a leap year.")
  (version "0.1")

  (type ExitCode
    (alias Int32)
  )

  (fn is-leap-year
    (doc "Return 1 if year is leap year, 0 otherwise.")
    (params (year Int32))
    (returns Int32)
    (body
      (do
        ;; Divisible by 4
        (let div4 Int32 (/ year 4))
        (let by4 Int32 (* div4 4))
        (if-stmt (!= by4 year)
          (return 0)
          (do 0)
        )
        ;; Divisible by 100
        (let div100 Int32 (/ year 100))
        (let by100 Int32 (* div100 100))
        (if-stmt (== by100 year)
          (do
            ;; Must also be divisible by 400
            (let div400 Int32 (/ year 400))
            (let by400 Int32 (* div400 400))
            (if-stmt (== by400 year)
              (return 1)
              (return 0)
            )
          )
          (return 1)
        )
      )
    )
  )

  (entry main
    (doc "Count leap years in [2000, 2004, 2100, 2016] = 3, multiply by 14.")
    (params ())
    (returns ExitCode)
    (body
      (do
        (let count Int32 0)
        (if-stmt (!= (is-leap-year 2000) 0) (set count (+ count 1)) (do 0))
        (if-stmt (!= (is-leap-year 2004) 0) (set count (+ count 1)) (do 0))
        (if-stmt (!= (is-leap-year 2100) 0) (set count (+ count 1)) (do 0))
        (if-stmt (!= (is-leap-year 2016) 0) (set count (+ count 1)) (do 0))
        ;; count = 3 (2100 is not leap year), 3 * 14 = 42
        (return (* count 14))
      )
    )
  )
)
