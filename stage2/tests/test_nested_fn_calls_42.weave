(program
  (name "test-nested-fn-calls-42")
  (doc "Test deeply nested function calls.")
  (version "0.1")

  (type ExitCode
    (alias Int32)
  )

  (fn add-one
    (doc "Add 1 to value.")
    (params (n Int32))
    (returns Int32)
    (body (+ n 1))
  )

  (fn double-value
    (doc "Multiply value by 2.")
    (params (n Int32))
    (returns Int32)
    (body (* n 2))
  )

  (fn subtract-five
    (doc "Subtract 5 from value.")
    (params (n Int32))
    (returns Int32)
    (body (- n 5))
  )

  (entry main
    (doc "Nested calls: subtract-five(double-value(add-one(add-one(20)))).")
    (params ())
    (returns ExitCode)
    (body
      ;; add-one(add-one(20)) = 22
      ;; double-value(22) = 44
      ;; subtract-five(44) = 39
      ;; Need to add 3 to get 42
      (+ (subtract-five (double-value (add-one (add-one 20)))) 3)
    )
  )
)
