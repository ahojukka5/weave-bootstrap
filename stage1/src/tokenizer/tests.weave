(tests
  (test is-whitespace-space (doc "ASCII 32 (space) is whitespace") (tags unit tokenizer)
    (body (let result Int32 (is-whitespace 32)) (expect-eq result 1)))
  (test is-whitespace-tab (doc "ASCII 9 (tab) is whitespace") (tags unit tokenizer)
    (body (let result Int32 (is-whitespace 9)) (expect-eq result 1)))
  (test is-whitespace-letter (doc "ASCII 65 (A) is not whitespace") (tags unit tokenizer)
    (body (let result Int32 (is-whitespace 65)) (expect-eq result 0)))

  (test is-digit-zero (doc "ASCII 48 (0) is a digit") (tags unit tokenizer)
    (body (let result Int32 (is-digit 48)) (expect-eq result 1)))
  (test is-digit-five (doc "ASCII 53 (5) is a digit") (tags unit tokenizer)
    (body (let result Int32 (is-digit 53)) (expect-eq result 1)))
  (test is-digit-letter (doc "ASCII 65 (A) is not a digit") (tags unit tokenizer)
    (body (let result Int32 (is-digit 65)) (expect-eq result 0)))

  (test is-symbol-start-uppercase (doc "ASCII 65 (A) can start a symbol") (tags unit tokenizer)
    (body (let result Int32 (is-symbol-start 65)) (expect-eq result 1)))
  (test is-symbol-start-lowercase (doc "ASCII 97 (a) can start a symbol") (tags unit tokenizer)
    (body (let result Int32 (is-symbol-start 97)) (expect-eq result 1)))
  (test is-symbol-start-plus (doc "ASCII 43 (+) can start a symbol") (tags unit tokenizer)
    (body (let result Int32 (is-symbol-start 43)) (expect-eq result 1)))
  (test is-symbol-start-digit (doc "ASCII 48 (0) cannot start a symbol") (tags unit tokenizer)
    (body (let result Int32 (is-symbol-start 48)) (expect-eq result 0)))

  (test is-symbol-char-digit (doc "digits can appear in symbol") (tags unit tokenizer)
    (body (let result Int32 (is-symbol-char 48)) (expect-eq result 1)))
  (test is-symbol-char-letter (doc "letters can appear in symbol") (tags unit tokenizer)
    (body (let result Int32 (is-symbol-char 97)) (expect-eq result 1)))

  (test skip-ws-and-comments-spaces (doc "skip multiple spaces returns correct index") (tags unit tokenizer)
    (body (let result Int32 (skip-ws-and-comments "   a" 0)) (expect-eq result 3)))
  (test skip-ws-and-comments-comment (doc "skip comment line returns correct index") (tags unit tokenizer)
    (body (let src String "; comment\na") (let result Int32 (skip-ws-and-comments src 0)) (expect-eq result 10)))
  (test skip-ws-and-comments-no-ws (doc "no whitespace returns same index") (tags unit tokenizer)
    (body (let result Int32 (skip-ws-and-comments "abc" 0)) (expect-eq result 0)))

  (test read-while-digits (doc "read-while mode 0 reads all digits") (tags unit tokenizer)
    (body (let b Buffer (buffer-new)) (let idx Int32 (read-while "123abc" 0 b 0)) (let s String (buffer-to-string b)) (let len Int32 (string-length s)) (expect-eq len 3)))
  (test read-while-symbols (doc "read-while mode 1 reads symbol chars") (tags unit tokenizer)
    (body (let b Buffer (buffer-new)) (let idx Int32 (read-while "abc123(" 0 b 1)) (let s String (buffer-to-string b)) (let len Int32 (string-length s)) (expect-eq len 6)))

  (test read-string-simple (doc "read-string extracts content between quotes") (tags unit tokenizer)
    (body (let b Buffer (buffer-new)) (let idx Int32 (read-string "\"hello\"x" 0 b)) (let s String (buffer-to-string b)) (let len Int32 (string-length s)) (expect-eq len 5)))
  (test read-string-empty (doc "read-string handles empty string") (tags unit tokenizer)
    (body (let b Buffer (buffer-new)) (let idx Int32 (read-string "\"\"x" 0 b)) (let s String (buffer-to-string b)) (let len Int32 (string-length s)) (expect-eq len 0)))

  (test tokenize-parens (doc "tokenize should recognize parentheses") (tags unit tokenizer)
    (body (let tokens ArrayString (array-str-new)) (tokenize "()" tokens) (let count Int32 (array-str-len tokens)) (expect-eq count 3)))
  (test tokenize-number (doc "tokenize should recognize numbers") (tags unit tokenizer)
    (body (let tokens ArrayString (array-str-new)) (tokenize "42" tokens) (let count Int32 (array-str-len tokens)) (expect-eq count 2)))
  (test tokenize-symbol (doc "tokenize should recognize symbols") (tags unit tokenizer)
    (body (let tokens ArrayString (array-str-new)) (tokenize "test" tokens) (let count Int32 (array-str-len tokens)) (expect-eq count 2)))
)
